<!-- use python -m simpleHTTPServer 3000 -->

<html>
<head>
  <!-- RSVP -->
  <script src="node_modules/rsvp/dist/rsvp.min.js"></script>
  <!-- Firebase -->
  <script src="https://cdn.firebase.com/js/client/1.0.17/firebase.js"></script>
  <!-- GeoFire -->
  <script src="https://cdn.firebase.com/libs/geofire/2.0.0/geofire.min.js"></script>

  <script src="https://code.jquery.com/jquery-2.1.3.js"></script>


</head>

<body>
<form id="target" action="" method="post">
  <input id="name" type="text" name="name">
  <input type="submit" value="Submit">
</form>

<script>

  var x = $('name');
  // $('body').append('<div> Kikikikik </div>')
  $( "#target" ).submit(function( event ) {
    var data = $("#target :input")[0].value;
    this.reset();
    event.preventDefault();
    console.log('data',data);

    function getLocation() {
      console.log('gets to get location');
      if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(showPosition);
      }
    };
    getLocation();
    var lat = 25;
    var lon = 25;

    function showPosition(position) {
      console.log('position is',position);
      lat = position.coords.latitude;
      lon = position.coords.longitude;

      var firebaseRef = new Firebase("https://intense-inferno-9753.firebaseio.com/geofire/");
      var geoFire = new GeoFire(firebaseRef);

      geoFire.set(data, [lat,lon]).then(function() {
        console.log("Provided key has been added to GeoFire");
      }, function(error) {
        console.log("Error: " + error);
      });
    }


  });


 </script>

</body>

</html>
